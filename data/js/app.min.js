function initializePrinterDiscovery(){console.log("🔌 Initializing real-time printer discovery (SSE)");let e=null;!function t(){e&&e.close(),e=new EventSource("/events"),e.addEventListener("printer-update",function(e){try{console.log("🖨️ Real-time printer update received");updatePrintersFromData(JSON.parse(e.data)),refreshPrinterUI()}catch(e){console.error("Error parsing printer update:",e)}}),e.addEventListener("system-status",function(e){try{const t=JSON.parse(e.data);console.log(`📡 System status: ${t.status} - ${t.message}`),showSystemNotification(t.status,t.message)}catch(e){console.error("Error parsing system status:",e)}}),e.onerror=function(e){console.error("SSE connection error:",e),setTimeout(()=>{console.log("🔄 Attempting to reconnect SSE..."),t()},5e3)},e.onopen=function(e){console.log("✅ Real-time updates connected")}}(),window.addEventListener("beforeunload",function(){e&&e.close()})}function updatePrintersFromData(e){if(e&&e.discovered_printers){const t=new CustomEvent("printersUpdated",{detail:{printers:e.discovered_printers}});document.dispatchEvent(t)}}function refreshPrinterUI(){}function showSystemNotification(e,t){if(!["connected","error","reconnecting"].includes(e))return;const n=document.createElement("div");switch(n.className=`notification notification-${e}`,n.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    padding: 10px 15px;\n    border-radius: 4px;\n    color: white;\n    font-size: 14px;\n    z-index: 10000;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n  ",e){case"connected":n.style.backgroundColor="#10b981";break;case"error":n.style.backgroundColor="#ef4444";break;case"reconnecting":n.style.backgroundColor="#f59e0b"}n.textContent=t,document.body.appendChild(n),requestAnimationFrame(()=>{n.style.opacity="1"}),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n)},300)},3e3)}function setupBackButtonListeners(){const e=document.getElementById("back-button");e&&e.addEventListener("click",goBack)}function handleKeyPress(e){if((e.ctrlKey||e.metaKey)&&"Enter"===e.key){e.preventDefault();const t=document.querySelector("form");t&&t.dispatchEvent(new Event("submit"))}if("Escape"===e.key){closeDiagnostics();const e=document.getElementById("settings-panel");e&&!e.classList.contains("hidden")&&toggleSettings()}}function handleTextareaKeydown(e){if("Enter"===e.key&&!e.shiftKey){e.preventDefault();const t=e.target.closest("form");if(t){const e=new Event("submit",{bubbles:!0,cancelable:!0});t.dispatchEvent(e)}}}function initializeSharedUI(){document.querySelectorAll(".loading").forEach(e=>e.classList.add("hidden")),initializeTooltips(),checkStartupMessages()}function initializeTooltips(){document.querySelectorAll(".info-icon").forEach(e=>{e.addEventListener("mouseenter",function(){})})}function checkStartupMessages(){const e=new URLSearchParams(window.location.search),t=e.get("message"),n=e.get("type");t&&("success"===n?showSuccessMessage(decodeURIComponent(t)):"error"===n&&showErrorMessage(decodeURIComponent(t)),window.history.replaceState({},document.title,window.location.pathname))}function showErrorMessage(e){const t=document.getElementById("message-container")||document.body,n=document.createElement("div");n.className="fixed top-4 right-4 bg-red-500 dark:bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg dark:shadow-2xl z-50",n.textContent=e,t.appendChild(n),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n)},5e3)}function showSuccessMessage(e){const t=document.getElementById("message-container")||document.body,n=document.createElement("div");n.className="fixed top-4 right-4 bg-green-500 dark:bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg dark:shadow-2xl z-50",n.textContent=e,t.appendChild(n),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n)},3e3)}function goBack(){window.history.length>1&&document.referrer?window.history.back():window.location.href="/"}document.addEventListener("DOMContentLoaded",function(){document.addEventListener("keydown",handleKeyPress),initializeSharedUI(),setupBackButtonListeners(),window.startAlpine&&"function"==typeof window.startAlpine&&window.startAlpine()});