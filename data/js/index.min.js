function initializeIndexUI(){const e=document.getElementById("message-textarea");e&&(e.addEventListener("input",()=>updateCharacterCount("message-textarea","char-counter",MAX_CHARS)),updateCharacterCount("message-textarea","char-counter",MAX_CHARS))}function initializePrinterSelection(){const e=document.getElementById("printer-selection");if(!e)return;e.innerHTML="";const r=createPrinterOption("local-direct","🖨️",`Local direct (${window.GLOBAL_CONFIG?.printers?.local?.name||"Unknown"})`,!0);e.appendChild(r),"undefined"!=typeof PRINTERS&&PRINTERS.forEach(r=>{const t=createPrinterOption(r.topic,"📡",`${r.name} via MQTT`,!1);e.appendChild(t)})}function createPrinterOption(e,r,t,a=!1){const n=document.createElement("div");n.className="printer-option cursor-pointer p-4 rounded-xl border-2 transition-all duration-200 hover:scale-105 hover:shadow-md "+(a?"border-orange-400 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 dark:border-orange-600":"border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500"),n.setAttribute("data-value",e);let o="Unknown";return o="local-direct"===e?"Direct connection":"MQTT connection",n.innerHTML=`\n    <div class="flex items-center space-x-3">\n      <span class="text-2xl">${r}</span>\n      <div>\n        <div class="font-medium text-sm">${t}</div>\n        <div class="text-xs text-gray-500 dark:text-gray-400">${o}</div>\n      </div>\n    </div>\n  `,n.addEventListener("click",()=>selectPrinter(e,n)),n}function selectPrinter(e,r){document.querySelectorAll(".printer-option").forEach(e=>{e.className=e.className.replace(/border-orange-400|bg-orange-50|text-orange-700|dark:bg-orange-900\/20|dark:text-orange-300|dark:border-orange-600/g,"").replace(/border-gray-200|bg-gray-50|text-gray-700|dark:border-gray-600|dark:bg-gray-700|dark:text-gray-300/g,"")+" border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500"}),r.className=r.className.replace(/border-gray-200|bg-gray-50|text-gray-700|hover:border-gray-300|dark:border-gray-600|dark:bg-gray-700|dark:text-gray-300|dark:hover:border-gray-500/g,"")+" border-orange-400 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 dark:border-orange-600";const t=document.getElementById("printer-target");t&&(t.value=e)}function initializeConfigDependentUI(){initializePrinterSelection()}function updateCharacterCount(e,r,t=1e3){const a=document.getElementById(e),n=document.getElementById(r);if(a&&n){const e=a.value.length,r=t;n.textContent=`${e}/${r} characters`;const o=n.parentElement;o&&(o.classList.remove("text-gray-500","text-yellow-700","text-red-600","dark:text-gray-400","dark:text-yellow-300","dark:text-red-400"),e>r?o.classList.add("text-red-600","dark:text-red-400"):e>=.8*r?o.classList.add("text-yellow-700","dark:text-yellow-300"):o.classList.add("text-gray-500","dark:text-gray-400"))}}function goToSettings(){window.location.href="/settings.html"}document.addEventListener("DOMContentLoaded",function(){initializeIndexUI(),initializeConfigDependentUI()});