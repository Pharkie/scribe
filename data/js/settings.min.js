async function loadConfiguration(){try{console.log("API: Loading configuration from server...");const e=await fetch("/api/config");if(!e.ok)throw new Error(`Config API returned ${e.status}: ${e.statusText}`);const t=await e.json();return console.log("API: Configuration loaded successfully"),t}catch(e){throw console.error("API: Failed to load configuration:",e),e}}async function saveConfiguration(e){try{console.log("API: Sending config to server..."),console.log("API: Config data:",JSON.stringify(e,null,2));const t=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw console.error("API: Server error response:",e),new Error(`Server error: ${t.status} - ${e}`)}const n=await t.text();return console.log("API: Server response:",n),n}catch(e){throw console.error("API: Failed to save configuration:",e),e}}async function testUnbiddenInkGeneration(e){try{const t=await fetch("/api/unbidden-ink",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})});if(!t.ok){let e=(await t.json().catch(()=>({}))).error||`HTTP ${t.status}: ${t.statusText}`;throw 500===t.status&&e.includes("Failed to generate")&&(e="Failed to generate content. Please check that your ChatGPT API Token is valid and you have sufficient API credits. You can check your account at https://platform.openai.com/account"),new Error(e)}return await t.json()}catch(e){throw console.error("API: Failed to test Unbidden Ink:",e),e}}async function printLocalContent(e){try{const t=await fetch("/api/print-local",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||`Print failed: HTTP ${t.status}`)}}catch(e){throw console.error("API: Failed to print content:",e),e}}async function triggerLedEffect(e,t=1e4){try{const n=await fetch("/api/led-effect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({effect:e,duration:t})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(e){throw console.error("API: Failed to trigger LED effect:",e),e}}async function turnOffLeds(){try{const e=await fetch("/api/leds-off",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw console.error("API: Failed to turn off LEDs:",e),e}}function populateForm(e){setElementValue("device-owner",e.device?.owner||""),setElementValue("timezone",e.device?.timezone||""),setElementValue("wifi-ssid",e.wifi?.ssid||""),setElementValue("wifi-password",e.wifi?.password||""),setElementValue("wifi-timeout",(e.wifi?.connect_timeout||15e3)/1e3),setElementValue("mqtt-server",e.mqtt?.server||""),setElementValue("mqtt-port",e.mqtt?.port||1883),setElementValue("mqtt-username",e.mqtt?.username||""),setElementValue("mqtt-password",e.mqtt?.password||""),setElementValue("max-characters",e.validation?.maxCharacters||500),setElementValue("chatgpt-api-token",e.apis?.chatgptApiToken||""),setElementChecked("unbidden-ink-enabled",e.unbiddenInk?.enabled||!1),setElementValue("time-start",e.unbiddenInk?.startHour||8),setElementValue("time-end",e.unbiddenInk?.endHour||22),updateTimeRange(),setElementValue("frequency-minutes",e.unbiddenInk?.frequencyMinutes||60),setElementValue("unbidden-ink-prompt",e.unbiddenInk?.prompt||"");for(let t=0;t<4;t++){const n=t+1;setElementValue(`button${n}-short`,e.buttons?.[`button${n}`]?.shortAction||""),setElementValue(`button${n}-long`,e.buttons?.[`button${n}`]?.longAction||""),setElementValue(`button${n}-short-mqtt-topic`,e.buttons?.[`button${n}`]?.shortMqttTopic||""),setElementValue(`button${n}-long-mqtt-topic`,e.buttons?.[`button${n}`]?.longMqttTopic||"")}window.SettingsLED&&window.SettingsLED.populateLedForm&&window.SettingsLED.populateLedForm(e),updateNextScheduledDisplay(e.status?.unbiddenInk?.nextScheduled)}function collectFormData(){const e={device:{owner:getElementValue("device-owner"),timezone:getElementValue("timezone")},wifi:{ssid:getElementValue("wifi-ssid"),password:getElementValue("wifi-password"),connect_timeout:1e3*getElementIntValue("wifi-timeout",15)},mqtt:{server:getElementValue("mqtt-server"),port:getElementIntValue("mqtt-port",1883),username:getElementValue("mqtt-username"),password:getElementValue("mqtt-password")},validation:{maxCharacters:getElementIntValue("max-characters",500)},apis:{chatgptApiToken:getElementValue("chatgpt-api-token")},unbiddenInk:{enabled:getElementChecked("unbidden-ink-enabled"),startHour:getElementIntValue("time-start",8),endHour:getElementIntValue("time-end",22),frequencyMinutes:getElementIntValue("frequency-minutes",60),prompt:getElementValue("unbidden-ink-prompt")},buttons:{}};for(let t=0;t<4;t++){const n=t+1,o=`button${n}`;e.buttons[o]={shortAction:getElementValue(`button${n}-short`),longAction:getElementValue(`button${n}-long`),shortMqttTopic:getElementValue(`button${n}-short-mqtt-topic`),longMqttTopic:getElementValue(`button${n}-long-mqtt-topic`)}}return window.SettingsLED&&window.SettingsLED.collectLedConfig?e.leds=window.SettingsLED.collectLedConfig():e.leds={pin:getElementIntValue("led-pin",4),count:getElementIntValue("led-count",30),brightness:getElementIntValue("led-brightness",64),refreshRate:getElementIntValue("led-refresh-rate",60)},e}function showSettingsSection(e){document.querySelectorAll(".settings-section").forEach(e=>{e.classList.add("hidden")});const t=document.getElementById(`${e}-section`);t&&t.classList.remove("hidden");document.querySelectorAll(".section-nav-btn").forEach(e=>{e.classList.remove("active")});const n=document.querySelector(`[onclick="showSettingsSection('${e}')"]`);n&&n.classList.add("active")}function hideLoadingState(){const e=document.getElementById("loading-state"),t=document.getElementById("settings-navigation"),n=document.getElementById("settings-form");e&&(e.style.display="none"),t&&t.classList.remove("hidden"),n&&(n.classList.remove("hidden"),showSettingsSection("wifi"))}function showMessage(e,t){window.showToast?window.showToast(e,t):"error"===t?alert("Error: "+e):"success"===t?console.log("Success: "+e):console.log(t+": "+e)}function toggleUnbiddenInkSettings(){const e=document.getElementById("unbidden-ink-enabled"),t=document.getElementById("unbidden-ink-settings");e&&t&&(e.checked?t.classList.remove("hidden"):t.classList.add("hidden"))}function updateTimeRange(){const e=document.getElementById("time-start"),t=document.getElementById("time-end");if(!e||!t)return;let n=parseInt(e.value),o=parseInt(t.value);0===n&&0===o||n>=o&&(o<24?(o=n+1,t.value=o):(n=23,e.value=n)),n=parseInt(e.value),o=parseInt(t.value);const s=document.getElementById("time-track");if(s)if(0===n&&0===o)s.style.left="0%",s.style.width="100%";else{const e=n/24*100,t=o/24*100;s.style.left=e+"%",s.style.width=t-e+"%"}const i=document.getElementById("time-display-start"),a=document.getElementById("time-display-end"),r=e=>24===e?"00:00":String(e).padStart(2,"0")+":00";i&&(i.textContent=r(n)),a&&(a.textContent=r(o)),updateClickAreas(),updateFrequencyDisplay()}function updateNextScheduledDisplay(e){const t=document.getElementById("next-scheduled-display");if(t&&e){const n=new Date(e);t.textContent=`Next: ${n.toLocaleString()}`}}function goBack(){window.location.href="/"}function handleSliderClick(e,t){const n=document.getElementById("time-start"),o=document.getElementById("time-end");if(!n||!o)return;const s=e.currentTarget.getBoundingClientRect(),i=(e.clientX-s.left)/s.width*100,a=Math.round(i/100*24);if("start"===t){const e=Math.max(0,Math.min(24,a)),t=parseInt(o.value);if(e>=t&&(0!==e||0!==t)){if(!(t<24))return n.value=t-1,updateTimeRange(),void updateClickAreas();o.value=e+1}n.value=e,updateTimeRange()}else if("end"===t){const e=Math.max(0,Math.min(24,a)),t=parseInt(n.value);if(e<=t&&(0!==t||0!==e)){if(!(t>0))return o.value=t+1,updateTimeRange(),void updateClickAreas();n.value=e-1}o.value=e,updateTimeRange()}updateClickAreas()}function updateClickAreas(){const e=document.getElementById("time-start"),t=document.getElementById("time-end"),n=document.getElementById("click-area-start"),o=document.getElementById("click-area-end");if(!(e&&t&&n&&o))return;const s=parseInt(e.value)/24*100,i=(parseInt(t.value)+1)/24*100,a=(s+i)/2,r=Math.max(0,s-7.5),d=Math.min(a-1,s+7.5);n.style.left=r+"%",n.style.width=d-r+"%";const l=Math.max(a+1,i-7.5),c=Math.min(100,i+7.5);o.style.left=l+"%",o.style.width=c-l+"%"}function updateFrequencyFromSlider(e){const t=[15,30,45,60,120,240,360,480][parseInt(e)],n=document.getElementById("frequency-minutes");n&&(n.value=t,updateFrequencyDisplay())}function updateSliderFromFrequency(e){const t=[15,30,45,60,120,240,360,480].indexOf(parseInt(e)),n=document.getElementById("frequency-slider");n&&-1!==t&&(n.value=t)}function updateFrequencyDisplay(){const e=document.getElementById("frequency-minutes"),t=document.getElementById("frequency-display"),n=document.getElementById("time-start"),o=document.getElementById("time-end");if(!(e&&t&&n&&o))return;const s=parseInt(e.value),i=parseInt(n.value),a=parseInt(o.value),r=e=>0===e||24===e?"12 am":e<12?`${e} am`:12===e?"12 pm":e-12+" pm",d=r(i),l=r(a);let c;if(s<60)c=`Around every ${s} minutes from ${d} to ${l} each day`;else{const e=Math.floor(s/60),t=s%60;c=0===t?`Around every ${e} hour${1!==e?"s":""} from ${d} to ${l} each day`:`Around every ${e}h ${t}m from ${d} to ${l} each day`}t.textContent=c}function setFrequency(e){const t=document.getElementById("frequency-minutes");t&&(t.value=e,updateFrequencyDisplay(),updateSliderFromFrequency(e))}function setPrompt(e){const t=document.getElementById("unbidden-ink-prompt");t&&(t.value=e,t.dispatchEvent(new Event("input")))}function setElementValue(e,t){const n=document.getElementById(e);n&&(n.value=t||"")}function setElementChecked(e,t){const n=document.getElementById(e);n&&(n.checked=!!t)}function getElementValue(e,t=""){const n=document.getElementById(e);return n&&n.value||t}function getElementIntValue(e,t){const n=document.getElementById(e);if(!n)return t;const o=parseInt(n.value);return isNaN(o)?t:o}function getElementChecked(e){const t=document.getElementById(e);return!!t&&t.checked}function formatTime(e){return`${0===e?12:e>12?e-12:e}:00 ${e>=12?"PM":"AM"}`}function colorToHtml(e,t){const n=e||t;return n.length>7?n.substring(0,7):n}function colorToRgba(e){return 7===e.length?e+"ff":e}function populateLedForm(e){if(!e.leds)return;const t=document.getElementById("led-pin"),n=document.getElementById("led-count"),o=document.getElementById("led-brightness"),s=document.getElementById("led-refresh-rate");t&&(t.value=e.leds.pin||4),n&&(n.value=e.leds.count||30),o&&(o.value=e.leds.brightness||64),s&&(s.value=e.leds.refreshRate||60);const i=e.leds.effects||{},a=i.chaseSingle||{},r={speed:document.getElementById("chase-single-speed"),trailLength:document.getElementById("chase-single-trail-length"),trailFade:document.getElementById("chase-single-trail-fade"),color:document.getElementById("chase-single-color")};r.speed&&(r.speed.value=a.speed||5),r.trailLength&&(r.trailLength.value=a.trailLength||15),r.trailFade&&(r.trailFade.value=a.trailFade||15),r.color&&(r.color.value=colorToHtml(a.defaultColor,"#0062ff"));const d=i.chaseMulti||{},l={speed:document.getElementById("chase-multi-speed"),trailLength:document.getElementById("chase-multi-trail-length"),trailFade:document.getElementById("chase-multi-trail-fade"),colorSpacing:document.getElementById("chase-multi-color-spacing"),color1:document.getElementById("chase-multi-color1"),color2:document.getElementById("chase-multi-color2"),color3:document.getElementById("chase-multi-color3")};l.speed&&(l.speed.value=d.speed||2),l.trailLength&&(l.trailLength.value=d.trailLength||20),l.trailFade&&(l.trailFade.value=d.trailFade||20),l.colorSpacing&&(l.colorSpacing.value=d.colorSpacing||12),l.color1&&(l.color1.value=colorToHtml(d.color1,"#ff9900")),l.color2&&(l.color2.value=colorToHtml(d.color2,"#008f00")),l.color3&&(l.color3.value=colorToHtml(d.color3,"#78cffe"));const c=i.matrix||{},u={speed:document.getElementById("matrix-speed"),drops:document.getElementById("matrix-drops"),backgroundFade:document.getElementById("matrix-background-fade"),trailFade:document.getElementById("matrix-trail-fade"),brightnessFade:document.getElementById("matrix-brightness-fade"),color:document.getElementById("matrix-color")};u.speed&&(u.speed.value=c.speed||3),u.drops&&(u.drops.value=c.drops||5),u.backgroundFade&&(u.backgroundFade.value=c.backgroundFade||64),u.trailFade&&(u.trailFade.value=c.trailFade||32),u.brightnessFade&&(u.brightnessFade.value=c.brightnessFade||40),u.color&&(u.color.value=colorToHtml(c.defaultColor,"#009100"));const g=i.twinkle||{},m={density:document.getElementById("twinkle-density"),fadeSpeed:document.getElementById("twinkle-fade-speed"),minBrightness:document.getElementById("twinkle-min-brightness"),maxBrightness:document.getElementById("twinkle-max-brightness"),color:document.getElementById("twinkle-color")};m.density&&(m.density.value=g.density||8),m.fadeSpeed&&(m.fadeSpeed.value=g.fadeSpeed||5),m.minBrightness&&(m.minBrightness.value=g.minBrightness||50),m.maxBrightness&&(m.maxBrightness.value=g.maxBrightness||255),m.color&&(m.color.value=colorToHtml(g.defaultColor,"#ffffff"));const f=i.pulse||{},w={speed:document.getElementById("pulse-speed"),minBrightness:document.getElementById("pulse-min-brightness"),maxBrightness:document.getElementById("pulse-max-brightness"),waveFrequency:document.getElementById("pulse-wave-frequency"),color:document.getElementById("pulse-color")};w.speed&&(w.speed.value=f.speed||4),w.minBrightness&&(w.minBrightness.value=f.minBrightness||0),w.maxBrightness&&(w.maxBrightness.value=f.maxBrightness||255),w.waveFrequency&&(w.waveFrequency.value=f.waveFrequency||.05),w.color&&(w.color.value=colorToHtml(f.defaultColor,"#ff00f2"));const h=i.rainbow||{},p={speed:document.getElementById("rainbow-speed"),saturation:document.getElementById("rainbow-saturation"),brightness:document.getElementById("rainbow-brightness"),hueStep:document.getElementById("rainbow-hue-step")};p.speed&&(p.speed.value=h.speed||2),p.saturation&&(p.saturation.value=h.saturation||255),p.brightness&&(p.brightness.value=h.brightness||255),p.hueStep&&(p.hueStep.value=h.hueStep||2.5)}function collectBasicLedConfig(){const e=(e,t)=>{const n=document.getElementById(e);if(!n)return t;const o=parseInt(n.value);return isNaN(o)?t:o};return{pin:e("led-pin",4),count:e("led-count",30),brightness:e("led-brightness",64),refreshRate:e("led-refresh-rate",60)}}async function demoLedEffect(e){try{const t=(e,t)=>{const n=document.getElementById(e);if(!n)return t;const o=parseInt(n.value);return isNaN(o)?t:o},n=(e,t)=>{const n=document.getElementById(e);if(!n)return t;const o=parseFloat(n.value);return isNaN(o)?t:o},o=(e,t)=>{const n=document.getElementById(e);return n&&n.value||t};let s={effect:e,duration:1e4};switch(e){case"chase_single":s.speed=t("chase-single-speed",5),s.trailLength=t("chase-single-trail-length",15),s.trailFade=t("chase-single-trail-fade",15),s.color1=o("chase-single-color","#0062ff");break;case"chase_multi":s.speed=t("chase-multi-speed",2),s.trailLength=t("chase-multi-trail-length",20),s.trailFade=t("chase-multi-trail-fade",20),s.colorSpacing=t("chase-multi-color-spacing",12),s.color1=o("chase-multi-color1","#ff9900"),s.color2=o("chase-multi-color2","#008f00"),s.color3=o("chase-multi-color3","#78cffe");break;case"matrix":s.speed=t("matrix-speed",3),s.drops=t("matrix-drops",5),s.backgroundFade=t("matrix-background-fade",64),s.trailFade=t("matrix-trail-fade",32),s.brightnessFade=t("matrix-brightness-fade",40),s.color1=o("matrix-color","#009100");break;case"twinkle":s.density=t("twinkle-density",8),s.fadeSpeed=t("twinkle-fade-speed",5),s.minBrightness=t("twinkle-min-brightness",50),s.maxBrightness=t("twinkle-max-brightness",255),s.color1=o("twinkle-color","#ffffff");break;case"pulse":s.speed=t("pulse-speed",4),s.minBrightness=t("pulse-min-brightness",0),s.maxBrightness=t("pulse-max-brightness",255),s.waveFrequency=n("pulse-wave-frequency",.05),s.color1=o("pulse-color","#ff00f2");break;case"rainbow":s.speed=n("rainbow-speed",2),s.saturation=t("rainbow-saturation",255),s.brightness=t("rainbow-brightness",255),s.hueStep=n("rainbow-hue-step",2.5)}console.log(`Demoing ${e} with config:`,s);const i=await fetch("/api/led-effect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);await i.json();window.SettingsCore&&window.SettingsCore.showMessage&&window.SettingsCore.showMessage(`${e} demo started!`,"success")}catch(t){console.error(`Failed to demo LED effect ${e}:`,t),window.SettingsCore&&window.SettingsCore.showMessage&&window.SettingsCore.showMessage(`Failed to demo ${e}: ${t.message}`,"error")}}async function turnOffLeds(){try{const e=await fetch("/api/leds-off",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);window.SettingsCore&&window.SettingsCore.showMessage&&window.SettingsCore.showMessage("LEDs turned off successfully!","success")}catch(e){console.error("Failed to turn off LEDs:",e),window.SettingsCore&&window.SettingsCore.showMessage&&window.SettingsCore.showMessage(`Failed to turn off LEDs: ${e.message}`,"error")}}function validateLedConfig(e){return e?e.pin<0||e.pin>21?{isValid:!1,error:"LED pin must be between 0 and 21 (ESP32-C3 compatible)"}:e.count<1||e.count>300?{isValid:!1,error:"LED count must be between 1 and 300"}:e.brightness<0||e.brightness>255?{isValid:!1,error:"LED brightness must be between 0 and 255"}:e.refreshRate<10||e.refreshRate>120?{isValid:!1,error:"LED refresh rate must be between 10 and 120 Hz"}:{isValid:!0}:{isValid:!1,error:"LED configuration is missing"}}async function initializeSettings(){try{await waitForModules();const e=await window.SettingsAPI.loadConfiguration();window.SettingsUI.populateForm(e),setupFormHandler(),setupEventHandlers(),window.SettingsUI.hideLoadingState(),console.log("Settings page initialized successfully")}catch(e){console.error("Failed to initialize settings page:",e),window.SettingsUI.showMessage("Failed to initialize settings page: "+e.message,"error")}}async function waitForModules(){let e=0;for(;e<5e3;){if(window.SettingsAPI&&window.SettingsUI&&window.SettingsLED)return;await new Promise(e=>setTimeout(e,100)),e+=100}throw new Error("Timeout waiting for settings modules to load")}function setupFormHandler(){const e=document.getElementById("settings-form");e&&e.addEventListener("submit",handleFormSubmit)}function setupEventHandlers(){const e=document.getElementById("unbidden-ink-enabled");e&&(e.addEventListener("change",window.SettingsUI.toggleUnbiddenInkSettings),window.SettingsUI.toggleUnbiddenInkSettings());const t=document.getElementById("time-start"),n=document.getElementById("time-end");t&&n&&(t.addEventListener("input",window.SettingsUI.updateTimeRange),n.addEventListener("input",window.SettingsUI.updateTimeRange))}async function handleFormSubmit(e){e.preventDefault();try{const e=window.SettingsUI.collectFormData();if(window.SettingsLED.validateLedConfig){const t=window.SettingsLED.validateLedConfig(e.leds);if(!t.isValid)return void window.SettingsUI.showMessage(t.error,"error")}await window.SettingsAPI.saveConfiguration(e),window.location.href="/?message=Settings saved successfully!&type=success"}catch(e){console.error("Failed to save settings:",e),window.SettingsUI.showMessage("Failed to save settings: "+e.message,"error")}}async function handleLedEffect(e){try{await window.SettingsAPI.triggerLedEffect(e),window.SettingsUI.showMessage(`${e} effect triggered successfully!`,"success")}catch(t){console.error("Failed to trigger LED effect:",t),window.SettingsUI.showMessage(`Failed to trigger ${e} effect: ${t.message}`,"error")}}async function handleTurnOffLeds(){try{await window.SettingsAPI.turnOffLeds(),window.SettingsUI.showMessage("LEDs turned off successfully!","success")}catch(e){console.error("Failed to turn off LEDs:",e),window.SettingsUI.showMessage(`Failed to turn off LEDs: ${e.message}`,"error")}}async function handleTestUnbiddenInk(){const e=event.target,t=e.textContent;try{if(!document.getElementById("chatgpt-api-token").value.trim())return void window.SettingsUI.showMessage("Please configure your ChatGPT API Token first. You can get one from https://platform.openai.com/api-keys","error");if(!document.getElementById("unbidden-ink-enabled").checked)return void window.SettingsUI.showMessage("Please enable Unbidden Ink first before testing.","error");const t=document.getElementById("unbidden-ink-prompt").value.trim();if(!t)return void window.SettingsUI.showMessage("Please enter a prompt in the Custom Prompt field before testing.","error");e.disabled=!0,e.textContent="Generating...";const n=await window.SettingsAPI.testUnbiddenInkGeneration(t);if(!n.content)throw new Error(n.error||"No content generated");await window.SettingsAPI.printLocalContent(n.content),window.SettingsUI.showMessage("Unbidden Ink generated and printed successfully","success")}catch(e){console.error("Failed to test Unbidden Ink:",e),window.SettingsUI.showMessage(`Failed to test Unbidden Ink: ${e.message}`,"error")}finally{e.disabled=!1,e.textContent=t}}window.SettingsAPI={loadConfiguration:loadConfiguration,saveConfiguration:saveConfiguration,testUnbiddenInkGeneration:testUnbiddenInkGeneration,printLocalContent:printLocalContent,triggerLedEffect:triggerLedEffect,turnOffLeds:turnOffLeds},window.SettingsUI={populateForm:populateForm,collectFormData:collectFormData,showSettingsSection:showSettingsSection,hideLoadingState:hideLoadingState,showMessage:showMessage,toggleUnbiddenInkSettings:toggleUnbiddenInkSettings,updateTimeRange:updateTimeRange,updateNextScheduledDisplay:updateNextScheduledDisplay,goBack:goBack,handleSliderClick:handleSliderClick,updateClickAreas:updateClickAreas,updateFrequencyFromSlider:updateFrequencyFromSlider,updateSliderFromFrequency:updateSliderFromFrequency,updateFrequencyDisplay:updateFrequencyDisplay,setFrequency:setFrequency,setPrompt:setPrompt},window.SettingsLED={populateLedForm:populateLedForm,collectLedConfig:collectBasicLedConfig,validateLedConfig:validateLedConfig,colorToHtml:colorToHtml,colorToRgba:colorToRgba,demoLedEffect:demoLedEffect},window.showSettingsSection=window.SettingsUI.showSettingsSection,window.goBack=window.SettingsUI.goBack,window.saveSettings=handleFormSubmit,window.triggerLedEffect=handleLedEffect,window.turnOffLeds=handleTurnOffLeds,window.testUnbiddenInk=handleTestUnbiddenInk,window.toggleUnbiddenInkSettings=window.SettingsUI.toggleUnbiddenInkSettings,window.handleSliderClick=window.SettingsUI.handleSliderClick,window.updateFrequencyFromSlider=window.SettingsUI.updateFrequencyFromSlider,window.setFrequency=window.SettingsUI.setFrequency,window.setPrompt=window.SettingsUI.setPrompt,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializeSettings):initializeSettings();