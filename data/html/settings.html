<!DOCTYPE html>
<html lang="en" class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Settings - Scribe</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/tailwind.css">
    <style>
        /* Dual-range slider styles */
        .range-slider-container {
            position: relative;
        }

        .range-slider-start,
        .range-slider-end {
            pointer-events: none;
            /* Disable default click behavior */
        }

        .range-slider-start::-webkit-slider-thumb,
        .range-slider-end::-webkit-slider-thumb {
            pointer-events: auto;
            position: relative;
            background: #8b5cf6;
            border: 2px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            width: 20px;
            height: 20px;
        }

        .range-slider-start::-webkit-slider-thumb {
            z-index: 24;
        }

        .range-slider-end::-webkit-slider-thumb {
            z-index: 23;
        }

        /* When dragging, bring to front */
        .range-slider-start:active::-webkit-slider-thumb {
            z-index: 25;
        }

        .range-slider-end:active::-webkit-slider-thumb {
            z-index: 25;
        }

        /* Custom click areas that will be positioned dynamically */
        .range-click-area {
            position: absolute;
            top: 0;
            height: 32px;
            cursor: pointer;
            z-index: 20;
        }

        .range-click-area-start {
            background: transparent;
        }

        .range-click-area-end {
            background: transparent;
        }
    </style>
</head>

<body
    class="flex flex-col min-h-screen justify-between py-8 px-4 font-sans bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <!-- Header with title and back button -->
    <header class="w-full max-w-4xl mx-auto flex items-center mb-8">
        <!-- Back button -->
        <div class="flex-1">
            <button onclick="goBack()"
                class="flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors duration-200">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="text-sm font-medium">Back</span>
            </button>
        </div>

        <!-- Centered title with settings icon -->
        <div class="flex-1 flex justify-center">
            <h1 class="text-4xl font-bold text-gray-800 dark:text-gray-100 flex items-center space-x-2">
                <span class="text-5xl">‚öôÔ∏è</span>
                <span>Settings</span>
            </h1>
        </div>

        <!-- Right spacer -->
        <div class="flex-1"></div>
    </header>

    <main class="w-full max-w-4xl mx-auto flex-1 space-y-6">
        <!-- Loading State -->
        <div id="loading-state"
            class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8 text-center">
            <div class="flex items-center justify-center space-x-3">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                <span class="text-gray-600 dark:text-gray-400">Loading configuration...</span>
            </div>
        </div>

        <!-- Settings Form -->
        <form id="settings-form" class="hidden space-y-6" onsubmit="saveSettings(event)">
            <!-- WiFi -->
            <div
                class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8">
                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-100 mb-6 flex items-center space-x-2">
                    <span class="text-3xl">üì∂</span>
                    <span>WiFi</span>
                </h2>

                <!-- WiFi Warning -->
                <div
                    class="mb-6 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-700 rounded-lg">
                    <div class="flex items-start space-x-3">
                        <span class="text-2xl">‚ö†Ô∏è</span>
                        <div>
                            <h3 class="text-lg font-semibold text-orange-800 dark:text-orange-300">WiFi Change Warning
                            </h3>
                            <p class="text-sm text-orange-700 dark:text-orange-400 mt-1">
                                Changing WiFi settings will cause the device to restart and connect to the new network.
                                Make sure the SSID and password are correct, or you may lose connection to the device!
                            </p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <label for="wifi-ssid" class="block text-sm font-medium text-gray-700 dark:text-gray-300">WiFi
                            SSID:</label>
                        <input type="text" id="wifi-ssid" name="wifi.ssid" required
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                    </div>
                    <div class="space-y-2">
                        <label for="wifi-password"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300">WiFi Password:</label>
                        <input type="password" id="wifi-password" name="wifi.password"
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                    </div>
                </div>
            </div>

            <!-- Device -->
            <div
                class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8">
                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-100 mb-6 flex items-center space-x-2">
                    <span class="text-3xl">‚öôÔ∏è</span>
                    <span>Device</span>
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <label for="device-owner"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300">Device Owner:</label>
                        <input type="text" id="device-owner" name="device.owner" required
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                    </div>
                    <div class="space-y-2">
                        <label for="timezone"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300">Timezone (IANA
                            format):</label>
                        <input type="text" id="timezone" name="device.timezone" required
                            placeholder="e.g. Europe/London, America/New_York, UTC"
                            pattern="^[A-Za-z_]+/[A-Za-z_]+$|^UTC$"
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                        <p class="text-sm text-gray-600 dark:text-gray-400">Use IANA timezone format (e.g.
                            Europe/London, America/New_York)</p>
                    </div>
                </div>
                <!-- Additional device settings -->
                <div class="mt-6">
                    <div class="space-y-2">
                        <label for="max-characters"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300">Max Message Characters
                            (100-5000):</label>
                        <input type="number" id="max-characters" name="validation.maxCharacters" min="100" max="5000"
                            required
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                    </div>
                </div>
            </div>

            <!-- MQTT -->
            <div
                class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8">
                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-100 mb-6 flex items-center space-x-2">
                    <span class="text-3xl">üì°</span>
                    <span>MQTT</span>
                </h2>
                <div class="space-y-6">
                    <!-- Server gets full width -->
                    <div class="space-y-2">
                        <label for="mqtt-server"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300">Server:</label>
                        <input type="text" id="mqtt-server" name="mqtt.server" required
                            class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                    </div>
                    <!-- Username, Password, Port share the row (1/3 each) -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="space-y-2">
                            <label for="mqtt-username"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300">Username:</label>
                            <input type="text" id="mqtt-username" name="mqtt.username" required
                                class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                        </div>
                        <div class="space-y-2">
                            <label for="mqtt-password"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password:</label>
                            <input type="password" id="mqtt-password" name="mqtt.password" required
                                class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                        </div>
                        <div class="space-y-2">
                            <label for="mqtt-port"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300">Port:</label>
                            <input type="number" id="mqtt-port" name="mqtt.port" min="1" max="65535" required
                                class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Unbidden Ink -->
            <div
                class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8">
                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-100 mb-6 flex items-center space-x-2">
                    <span class="text-3xl">ü™Ñ</span>
                    <span>Unbidden Ink</span>
                </h2>
                <div class="space-y-6">
                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                        <div class="flex items-center space-x-3">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100">Enable Unbidden Ink
                                </h3>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Automatically generate and print
                                    creative content</p>
                            </div>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="unbidden-ink-enabled" name="unbiddenInk.enabled"
                                class="sr-only peer" onchange="toggleUnbiddenInkSettings()">
                            <div
                                class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white dark:after:bg-gray-200 after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600 dark:peer-checked:bg-purple-500">
                            </div>
                        </label>
                    </div>

                    <div id="unbidden-ink-settings" class="space-y-6">
                        <!-- ChatGPT API Token -->
                        <div class="space-y-2">
                            <label for="chatgpt-api-token"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300">ChatGPT API
                                Token:</label>
                            <input type="password" id="chatgpt-api-token" name="apis.chatgptApiToken" required
                                class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                            <p class="text-sm text-gray-600 dark:text-gray-400">Your OpenAI API key for GPT access. <a
                                    href="https://platform.openai.com/api-keys" target="_blank"
                                    class="text-purple-600 dark:text-purple-400 hover:underline">Get your API key
                                    here</a>.</p>
                        </div>

                        <!-- Time Range Slider -->
                        <div class="space-y-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Active Time
                                Range:</label>
                            <div class="space-y-2">
                                <div class="relative h-8 range-slider-container">
                                    <!-- Background track container -->
                                    <div class="absolute w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg"
                                        style="top: 12px;"></div>

                                    <!-- Active time track (colored section) -->
                                    <div id="time-track" class="absolute h-2 bg-purple-500 rounded-lg"
                                        style="top: 12px; left: 33.33%; width: 58.33%;"></div>

                                    <!-- Dynamic click areas - will be positioned by JavaScript -->
                                    <div id="click-area-start" class="range-click-area range-click-area-start"
                                        onclick="handleSliderClick(event, 'start')"></div>
                                    <div id="click-area-end" class="range-click-area range-click-area-end"
                                        onclick="handleSliderClick(event, 'end')"></div>

                                    <!-- Start time handle - full width -->
                                    <input type="range" id="time-start" name="unbiddenInk.startHour" min="0" max="24"
                                        step="1" value="8"
                                        class="absolute w-full h-8 bg-transparent rounded-lg appearance-none cursor-pointer range-slider-start"
                                        style="top: 0; z-index: 24;" oninput="updateTimeRange(this, 'start')"
                                        onchange="updateClickAreas()">

                                    <!-- End time handle - full width -->
                                    <input type="range" id="time-end" name="unbiddenInk.endHour" min="0" max="24"
                                        step="1" value="22"
                                        class="absolute w-full h-8 bg-transparent rounded-lg appearance-none cursor-pointer range-slider-end"
                                        style="top: 0; z-index: 23;" oninput="updateTimeRange(this, 'end')"
                                        onchange="updateClickAreas()">
                                </div>

                                <!-- Time display -->
                                <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400 mt-4">
                                    <span id="time-display-start">08:00</span>
                                    <span class="text-purple-600 dark:text-purple-400 font-medium">Active Period</span>
                                    <span id="time-display-end">22:00</span>
                                </div>

                                <!-- Hour markers -->
                                <div class="mx-2">
                                    <div
                                        class="flex justify-between text-xs text-gray-400 dark:text-gray-500 mt-1 relative">
                                        <span style="position: absolute; left: 0%;">0</span>
                                        <span style="position: absolute; left: 4.17%;">1</span>
                                        <span style="position: absolute; left: 8.33%;">2</span>
                                        <span style="position: absolute; left: 12.5%;">3</span>
                                        <span style="position: absolute; left: 16.67%;">4</span>
                                        <span style="position: absolute; left: 20.83%;">5</span>
                                        <span style="position: absolute; left: 25%;">6</span>
                                        <span style="position: absolute; left: 29.17%;">7</span>
                                        <span style="position: absolute; left: 33.33%;">8</span>
                                        <span style="position: absolute; left: 37.5%;">9</span>
                                        <span style="position: absolute; left: 41.67%;">10</span>
                                        <span style="position: absolute; left: 45.83%;">11</span>
                                        <span style="position: absolute; left: 50%;">12</span>
                                        <span style="position: absolute; left: 54.17%;">13</span>
                                        <span style="position: absolute; left: 58.33%;">14</span>
                                        <span style="position: absolute; left: 62.5%;">15</span>
                                        <span style="position: absolute; left: 66.67%;">16</span>
                                        <span style="position: absolute; left: 70.83%;">17</span>
                                        <span style="position: absolute; left: 75%;">18</span>
                                        <span style="position: absolute; left: 79.17%;">19</span>
                                        <span style="position: absolute; left: 83.33%;">20</span>
                                        <span style="position: absolute; left: 87.5%;">21</span>
                                        <span style="position: absolute; left: 91.67%;">22</span>
                                        <span style="position: absolute; left: 95.83%;">23</span>
                                        <span style="position: absolute; left: 100%;">24</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Frequency Slider -->
                        <div class="space-y-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Generation
                                Frequency:</label>
                            <div class="space-y-4">
                                <!-- Frequency slider with non-linear scale -->
                                <div class="space-y-2">
                                    <div class="relative h-8">
                                        <!-- Background track -->
                                        <div class="absolute w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg"
                                            style="top: 12px;"></div>

                                        <!-- Frequency slider -->
                                        <input type="range" id="frequency-slider" min="0" max="7" step="1" value="3"
                                            class="absolute w-full h-8 bg-transparent rounded-lg appearance-none cursor-pointer"
                                            style="top: 0; z-index: 10;"
                                            oninput="updateFrequencyFromSlider(this.value)">
                                    </div>

                                    <!-- Frequency markers -->
                                    <div class="flex justify-between text-xs text-gray-400 dark:text-gray-500 mt-1">
                                        <span>15min</span>
                                        <span>30min</span>
                                        <span>45min</span>
                                        <span>1hr</span>
                                        <span>2hr</span>
                                        <span>4hr</span>
                                        <span>6hr</span>
                                        <span>8hr</span>
                                    </div>
                                </div>

                                <!-- Hidden input for the actual value -->
                                <input type="hidden" id="frequency-minutes" name="unbiddenInk.frequencyMinutes"
                                    value="60">

                                <!-- Current selection display -->
                                <div class="text-center">
                                    <span
                                        class="inline-flex items-center px-4 py-2 bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 rounded-lg text-sm font-medium">
                                        <span class="text-lg mr-2">‚è±Ô∏è</span>
                                        <span id="frequency-display">Around once per hour from 8 am to 10 pm each
                                            day</span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Prompt Presets and Custom Input -->
                        <div class="space-y-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Content Generation
                                Prompt:</label>

                            <!-- Prompt preset buttons -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                <button type="button"
                                    class="prompt-preset text-left p-4 rounded-xl border border-gray-300 dark:border-gray-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 focus:outline-none focus:ring-2 focus:ring-purple-400 transition-all"
                                    onclick="setPrompt('Generate a short, inspiring quote about creativity, technology, or daily life. Keep it under 200 characters.')">
                                    <div class="flex items-start space-x-3">
                                        <span class="text-2xl">üí≠</span>
                                        <div>
                                            <h4 class="font-medium text-gray-800 dark:text-gray-100">Inspirational
                                                Quotes</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Daily wisdom and
                                                motivation</p>
                                        </div>
                                    </div>
                                </button>

                                <button type="button"
                                    class="prompt-preset text-left p-4 rounded-xl border border-gray-300 dark:border-gray-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 focus:outline-none focus:ring-2 focus:ring-purple-400 transition-all"
                                    onclick="setPrompt('Generate a fun fact under 200 characters about BBC Doctor Who - the characters, episodes, behind-the-scenes trivia, or the show\'s history that is esoteric and only 5% of fans might know.')">
                                    <div class="flex items-start space-x-3">
                                        <span class="text-2xl">üï∞Ô∏è</span>
                                        <div>
                                            <h4 class="font-medium text-gray-800 dark:text-gray-100">Doctor Who Facts
                                            </h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Timey-wimey trivia and
                                                lore</p>
                                        </div>
                                    </div>
                                </button>

                                <button type="button"
                                    class="prompt-preset text-left p-4 rounded-xl border border-gray-300 dark:border-gray-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 focus:outline-none focus:ring-2 focus:ring-purple-400 transition-all"
                                    onclick="setPrompt('Write a short, humorous observation about everyday life or a witty one-liner. Keep it light and under 200 characters.')">
                                    <div class="flex items-start space-x-3">
                                        <span class="text-2xl">üòÑ</span>
                                        <div>
                                            <h4 class="font-medium text-gray-800 dark:text-gray-100">Humor & Wit</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Light-hearted
                                                observations</p>
                                        </div>
                                    </div>
                                </button>

                                <button type="button"
                                    class="prompt-preset text-left p-4 rounded-xl border border-gray-300 dark:border-gray-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 focus:outline-none focus:ring-2 focus:ring-purple-400 transition-all"
                                    onclick="setPrompt('Generate a short creative writing prompt, mini-story, or poetic thought. Be imaginative and keep under 250 characters.')">
                                    <div class="flex items-start space-x-3">
                                        <span class="text-2xl">‚ú®</span>
                                        <div>
                                            <h4 class="font-medium text-gray-800 dark:text-gray-100">Creative Sparks
                                            </h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Imaginative and artistic
                                                content</p>
                                        </div>
                                    </div>
                                </button>
                            </div>

                            <!-- Custom prompt textarea -->
                            <div class="space-y-2">
                                <label for="unbidden-ink-prompt"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Custom
                                    Prompt:</label>
                                <textarea id="unbidden-ink-prompt" name="unbiddenInk.prompt" rows="4"
                                    placeholder="Enter your custom prompt here, or click one of the preset buttons above..."
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent resize-none text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700"></textarea>
                            </div>

                            <!-- Test Unbidden Ink -->
                            <div class="pt-4 text-right">
                                <button type="button" onclick="testUnbiddenInk()"
                                    class="text-sm text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 hover:underline font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-purple-400 rounded">
                                    Bid Unbidden Ink To Print Now
                                </button>
                            </div>
                        </div>

                        <!-- Test Unbidden Ink -->
                        <div class="pt-4 border-t border-gray-200 dark:border-gray-600">
                            <button type="button" onclick="testUnbiddenInk()"
                                class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 px-6 rounded-xl font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
                                Bid Unbidden Ink To Print Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <!-- Buttons -->
            <div
                class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 shadow-2xl rounded-3xl p-8">
                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-100 mb-6 flex items-center space-x-2">
                    <span class="text-3xl">üîò</span>
                    <span>Buttons</span>
                </h2>
                <div class="space-y-6">

                    <!-- Button 1 -->
                    <div class="border border-gray-200 dark:border-gray-600 rounded-xl p-4">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100 mb-4">Button 1 (GPIO 5)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label for="button1-short"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Short Press
                                    Action:</label>
                                <select id="button1-short" name="buttons.button1.shortAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label for="button1-long"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Long Press
                                    Action:</label>
                                <select id="button1-long" name="buttons.button1.longAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Button 2 -->
                    <div class="border border-gray-200 dark:border-gray-600 rounded-xl p-4">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100 mb-4">Button 2 (GPIO 6)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label for="button2-short"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Short Press
                                    Action:</label>
                                <select id="button2-short" name="buttons.button2.shortAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label for="button2-long"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Long Press
                                    Action:</label>
                                <select id="button2-long" name="buttons.button2.longAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Button 3 -->
                    <div class="border border-gray-200 dark:border-gray-600 rounded-xl p-4">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100 mb-4">Button 3 (GPIO 7)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label for="button3-short"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Short Press
                                    Action:</label>
                                <select id="button3-short" name="buttons.button3.shortAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label for="button3-long"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Long Press
                                    Action:</label>
                                <select id="button3-long" name="buttons.button3.longAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Button 4 -->
                    <div class="border border-gray-200 dark:border-gray-600 rounded-xl p-4">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100 mb-4">Button 4 (GPIO 8)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label for="button4-short"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Short Press
                                    Action:</label>
                                <select id="button4-short" name="buttons.button4.shortAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label for="button4-long"
                                    class="block text-sm font-medium text-gray-700 dark:text-gray-300">Long Press
                                    Action:</label>
                                <select id="button4-long" name="buttons.button4.longAction"
                                    class="w-full p-3 rounded-xl border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-700">
                                    <option value="">None</option>
                                    <option value="/joke">Joke</option>
                                    <option value="/riddle">Riddle</option>
                                    <option value="/quote">Quote</option>
                                    <option value="/quiz">Quiz</option>
                                    <option value="/print-test">Print Test</option>
                                    <option value="/unbidden-ink">Unbidden Ink</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex space-x-4">
                <button type="button" onclick="goBack()"
                    class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-xl font-medium transition-all duration-200 hover:scale-[1.02] hover:shadow-lg">
                    Close
                </button>
                <button type="submit" id="save-button"
                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-medium transition-all duration-200 hover:scale-[1.02] hover:shadow-lg">
                    Save Settings
                </button>
            </div>
        </form>
    </main>

    <!-- Success/Error Messages -->
    <div id="message-container" class="fixed top-4 right-4 z-50"></div>

    <!-- Loading spinner for save operation -->
    <div id="save-loading"
        class="hidden fixed top-4 right-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg border p-4 flex items-center space-x-3 z-50">
        <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div>
        <span class="text-gray-800 dark:text-gray-100">Saving settings...</span>
    </div>

    <script src="/js/app.min.js"></script>
    <script src="/js/settings.js"></script>
</body>

</html>